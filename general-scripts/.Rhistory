}
if (in_memory){
return(df)
}
}
load_nba_data()
df1 <- read.csv('shotdetail2024.csv')
df1 <- read.csv('/shotdetail2024.csv')
getwd()
df1 <- read.csv('/Users/davidetissino/Desktop/R/NBA-Viz/general scripts/shotdetail2024.csv')
df1 <- read.csv('/Users/davidetissino/Desktop/R/NBA-Viz/general-scripts/shotdetail2024.csv')
library(tidyverse)
df1 <- read.csv('/Users/davidetissino/Desktop/R/NBA-Viz/general-scripts/shotdetail2024.csv')
df1 <- read.csv('/Users/davidetissino/Desktop/R/NBA-Viz/general-scripts/shotdetail_2024.csv')
df1 <- read.csv('shotdetail_2024.csv')
df1 <- read.csv('shotdetail_2024.csv')
df1 <- read.csv('shotdetail_2024.csv')
df1 <- read.csv('shotdetail_2024.csv')
df1 <- read.csv('shotdetail_2024.csv')
df1 <- read.csv('shotdetail_2024.csv')
df2 <- read.csv('pbpstats_2024.csv')
df3 <- read.csv('nbastats_2024.csv')
df4 <- read.csv('nbastatsv3_2024.csv')
df5 <- read.csv('matchups_2024.csv')
df6 <- read.csv('cdnnba_2024.csv')
df7 <- read.csv('datanba_2024.csv')
View(df1)
View(df2)
View(df3)
View(df4)
View(df4)
View(df6)
View(df7)
# example df
lbj <- get_shots(2544)
# Scraping function
get_shots <- function(player_id, season = "2024-25", season_type = "Regular Season"){
request <- GET(
"https://stats.nba.com/stats/shotchartdetail",
query = list(
PlayerID = player_id,
Season = season,
SeasonType = season_type,
PlayerPosition = "",
ContextMeasure = "FGA",
DateFrom = "",
DateTo = "",
GameID = "",
GameSegment = "",
LastNGames = 0,
LeagueID = "00",
Location = "",
Month = 0,
OpponentTeamID = 0,
Outcome = "",
Period = 0,
Position = "",
RookieYear = "",
SeasonSegment = "",
TeamID = 0,
VsConference = "",
VsDivision = ""
),
add_headers(.headers = request_headers)
)
json_resp <- fromJSON(content(request, "text"))
df <- data.frame(json_resp$resultSets$rowSet[1])
colnames(df) <- json_resp[["resultSets"]][["headers"]][[1]]
return(df)
}
# example df
lbj <- get_shots(2544)
# Headers for scraping
request_headers <- c(
"Accept" = "application/json, text/plain, */*",
"Accept-Language" = "en-US,en;q=0.8",
"Cache-Control" = "no-cache",
"Connection" = "keep-alive",
"Host" = "stats.nba.com",
"Pragma" = "no-cache",
"Referer" = "https://www.nba.com/",
"Upgrade-Insecure-Requests" = "1",
# using windows - change if different operating system
"User-Agent" = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36"
)
# FUNCTION: Player Shots In Game ====
# Each shot taken by a player during the season
library(httr)
library(jsonlite)
# example df
lbj <- get_shots(2544)
lbj
game_id <- '0022400784'
url <- paste0('https://stats.nba.com/stats/gamerotation?GameID=', game_id)
res <- GET(url = url, add_headers(.headers = headers))
res <- GET(url = url, add_headers(.headers = headers))
# Headers for scraping
request_headers <- c(
"Accept" = "application/json, text/plain, */*",
"Accept-Language" = "en-US,en;q=0.8",
"Cache-Control" = "no-cache",
"Connection" = "keep-alive",
"Host" = "stats.nba.com",
"Pragma" = "no-cache",
"Referer" = "https://www.nba.com/",
"Upgrade-Insecure-Requests" = "1",
# using windows - change if different operating system
"User-Agent" = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36"
)
json_resp <- fromJSON(content(res, "text"))
res <- GET(url = url, add_headers(.headers = headers))
# increase buffer size for scraping
Sys.setenv("VROOM_CONNECTION_SIZE" = 131072 * 2)
#### GAME ID ####
game_id <- '0022301187'
# headers
headers <- c(
`Connection` = 'keep-alive',
`Accept` = 'application/json, text/plain, */*',
`x-nba-stats-token` = 'true',
`X-NewRelic-ID` = 'VQECWF5UChAHUlNTBwgBVw==',
`User-Agent` = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36',
`x-nba-stats-origin` = 'stats',
`Sec-Fetch-Site` = 'same-origin',
`Sec-Fetch-Mode` = 'cors',
`Referer` = 'https://stats.nba.com/players/shooting/',
`Accept-Encoding` = 'gzip, deflate, br',
`Accept-Language` = 'en-US,en;q=0.9'
)
## SCRAPE GAME INFO ####
### Rotation Infos ====
url <- paste0('https://stats.nba.com/stats/gamerotation?GameID=', game_id)
res <- GET(url = url, add_headers(.headers = headers))
json_resp <- fromJSON(content(res, "text"))
# two tabs, home & away
home <- data.frame(json_resp[["resultSets"]][["rowSet"]][[2]])
away <- data.frame(json_resp[["resultSets"]][["rowSet"]][[1]])
colnames(home) <- json_resp[["resultSets"]][["headers"]][[1]]
colnames(away) <- json_resp[["resultSets"]][["heade
colnames(away) <- json_resp[["resultSets"]][["headers"]][[1]]
colnames(away) <- json_resp[["resultSets"]][["headers"]][[1]]
View(home)
library(hoopR)
pbp <- load_nba_pbp(seasons = 2024)
View(pbp)
pbp <- load_nba_pbp(seasons = 2025)
pbp
View(pbp)
colnames(pbp)
pbp1 <- pbpb[, c(1:50)]
pbp1 <- pbp[, c(1:50)]
pbp2 <- pbp[, c(51:62)]
View(pbp2)
View(pbp)
# Load schedule data for the season
schedule <- load_nba_schedule(season = 2025)
View(schedule)
colnames(schedule)
# Find the row where NBA game ID matches
game_info <- schedule[schedule$game_id == "0022400864", ]
View(game_info)
schedule2 <- schedule[, c(50:77)]
View(schedule2)
schedule2 <- schedule[, c(3, 50:77)]
# Find the row where NBA game ID matches
game_info <- schedule[schedule$game_id == "0022400864"]
# NBA's API blocks default R requests, so we need headers to mimic a browser
headers <- c(
"User-Agent" = "Mozilla/5.0",
"Accept-Language" = "en-US,en;q=0.5"
)
# Function to fetch game details from the NBA API
get_nba_game_details <- function(nba_game_id) {
url <- paste0("https://stats.nba.com/stats/scoreboardv3?GameDate=2024-02-28&LeagueID=00")
# NBA's API blocks default R requests, so we need headers to mimic a browser
headers <- c(
"User-Agent" = "Mozilla/5.0",
"Accept-Language" = "en-US,en;q=0.5"
)
response <- GET(url, add_headers(.headers = headers))
if (status_code(response) != 200) {
stop("Failed to fetch data. Check the game date and try again.")
}
json_data <- fromJSON(content(response, as = "text"))
# Extract game info
games <- json_data$scoreboard$games
# Find the game with the given NBA game ID
game_row <- games[games$gameId == nba_game_id, ]
if (nrow(game_row) == 0) {
stop("Game ID not found in the NBA API.")
}
return(game_row)
}
# Example: Get details for the game
nba_game_id <- "0022400864"
game_details <- get_nba_game_details(nba_game_id)
# Example: Get details for the game
nba_game_id <- "401705430"
game_details <- get_nba_game_details(nba_game_id)
# Load the ESPN scoreboard for the game’s date
scoreboard <- espn_nba_scoreboard("20250302")  # Format: YYYYMMDD
# Find the game by teams (since ESPN IDs differ)
game_info <- scoreboard[scoreboard$home_team == "Golden State Warriors" &
scoreboard$away_team == "Philadelphia 76ers", ]
# Load the ESPN scoreboard for the game’s date
scoreboard <- espn_nba_scoreboard("20250302")  # Format: YYYYMMDD
View(scoreboard)
# Load the ESPN scoreboard for the game’s date
scoreboard <- espn_nba_scoreboard("20250301")  # Format: YYYYMMDD
View(pbp1)
View(pbp)
colnames(pbp)
View(pbp2)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date = '2025-03-01' &&
home_team_name == 'Golden State Warriors'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-03-01' &&
home_team_name == 'Golden State Warriors'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-03-01' &
home_team_name == 'Golden State Warriors'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-03-01',
home_team_name == 'Golden State Warriors'
)
View(pbp)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-03-01',
home_team_abbr == 'PHI'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-03-01',
home_team_abbrev == 'PHI'
)
View(game_pbp)
espn_id <- game_pbp$game_id
espn_id <- unique(game_pbp$game_id)
espn_id <- unique(game_pbp$game_id)
espn_id
url <- 'https://www.nba.com/game/gsw-vs-hou-0022400784/play-by-play?period=All&latest=0'
res <- GET(url = url, add_headers(.headers = headers))
json_resp <- fromJSON(content(res, "text"))
View(res)
View(res)
View(res)
View(scoreboard)
View(df1)
View(game_info)
View(game_pbp)
View(game_pbp)
colnames(df2)
colnames(df3)
View(df4)
View(df3)
df3 <- read.csv('nbastats_2024.csv') %>%
filter(
GAME_ID == espn_id
)
df3 <- read.csv('nbastats_2024.csv')
View(df3)
df3 <- read.csv('nbastats_2024.csv') %>%
filter(
GAME_ID == '22301187'
)
View(df6)
View(df7)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-24',
home_team_abbrev == 'GSW'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-24',
home_team_abbrev == 'GS'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-24',
home_team_abbrev == 'DAL'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-23',
home_team_abbrev == 'DAL'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-25',
home_team_abbrev == 'DAL'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-25',
home_team_abbrev == 'GSW'
)
game_pbp <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-25',
home_team_abbrev == 'GS'
)
$
$
espn_id <- unique(game_pbp$game_id)
View(df3)
df3 <- read.csv('nbastats_2024.csv')
View(game_pbp)
df3 <- read.csv('nbastats_2024.csv') %>%
filter(
GAME_ID == '22400834'
)
library(nbastatR)
bref_injuries()
df <- bref_injuries()
df$descriptionInjury[1, ]
df$descriptionInjury[df[1, ]]
df$descriptionInjury[df$slugPlayerBREF == 'bufkiko01']
play_by_play(22301187)
df1 <- play_by_play(22301187)
View(df1)
game_pbp_nbastatR <- play_by_play(22301187)
game_pbp_nbastatR_v2 <- play_by_play_v2(22301187)
colnames(game_pbp)
colnames(game_pbp_nbastatR)
colnames(game_pbp_nbastatR_v2)
View(game_pbp)
View(game_pbp_nbastatR)
game_pbp_nbastatR <- play_by_play(22400834)
game_pbp_nbastatR_v2 <- play_by_play_v2(22400834)
View(game_pbp_nbastatR_v2)
View(game_pbp_nbastatR)
source("~/.active-rstudio-document")
teams_shots(
teams = 'Los Angeles Lakers',
team_ids = NULL,
all_active_teams = F,
season_types = "Regular Season",
seasons = 2025,
measures = "FGA",
periods = 0,
months = 0,
date_from = NA,
date_to = NA,
nest_data = F,
return_message = T
)
lbj2 <- teams_shots(
teams = 'Los Angeles Lakers',
team_ids = NULL,
all_active_teams = F,
season_types = "Regular Season",
seasons = 2025,
measures = "FGA",
periods = 0,
months = 0,
date_from = NA,
date_to = NA,
nest_data = F,
return_message = T
)
View(lbj2)
lbj2 <- lbj2 %>% filter(
namePlayer == 'LeBron James'
)
View(lbj)
current_schedule()
current_schedule()
current_standings()
days_scores()
days_scores(game_dates = '2025-03-02')
View(dataScoreTeamLeadersNBA)
View(dataScoreLineScoreNBA)
View(dataScoreTeamLeadersNBA)
View(dataScoreLastMeetingNBA)
View(dataScoreGameHeaderNBA)
View(game_pbp)
nba_pbp(401705400)
espn_nba_game_all(401705400)
espn_nba_pbp(401705400)
espn_data <- espn_nba_pbp(401705400)
colnames(espn_data)
game_pbp_hoopR <- load_nba_pbp(seasons = 2025) %>%
filter(
game_date == '2025-02-25',
home_team_abbrev == 'GS'
)
espn_id <- unique(game_pbp_hoopR$game_id)
game_pbp_nbastatR <- play_by_play(22400834)     # play by play for nba game id
View(game_pbp_hoopR)
game_pbp_hoopR_2 <- game_pbp_hoopR[, c(50:62)]
View(game_pbp_hoopR_2)
pbp_hoopR <- game_pbp_hoopR[, -c(1, 2, 4, 10, 14, 18, 24, 25, 28:30, 33:50, 52:57, 61:62)]
View(pbp_hoopR)
View(pbp)
pbp <-  pbp %>% filter(game_date == '2025-02-25')
pbp <- pbp %>% filter(game_id == espn_id)
game_pbp_hoopR <- load_nba_pbp(game_id == espn_id)
nba_pbp(espn_id)
nba_pbp(401705400)
nba_pbp(22301187)
espn_id <- 401705400
nba_id <- 22400834
game_pbp_hoopR <- load_nba_pbp(game_id == espn_id)
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
)
game_pbp_hoopR_nba <- nba_pbp(game_id == nba_id)
View(game_pbp_hoopR_nba)
nba_id <- 22400834
game_pbp_hoopR_nba <- nba_pbp(game_id == nba_id)
game_pbp_hoopR_nba <- nba_pbp(game_id == as.character(nba_id))
game_pbp_hoopR_nba <- nba_pbp(nba_id)
View(game_pbp_hoopR)
View(game_pbp_hoopR_nba)
colnames(pbp_hoopR)
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
) %>%
mutate(
home = paste(
home_team_name, home_team_mascot
),
awas = paste(
away_team_name, away_team_mascot
)
)
colnames(game_pbp_hoopR)
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
) %>%
mutate(
home = paste(
home_team_name, home_team_mascot
),
away = paste(
away_team_name, away_team_mascot
)
) %>%
.[, -c(1, 2, 4, 10, 14, 18, 24, 25, 28:50, 52:57, 61:62)]
View(game_pbp_hoopR)
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
) %>%
mutate(
home = paste(
home_team_name, home_team_mascot
),
away = paste(
away_team_name, away_team_mascot
)
) #%>%
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
) %>%
mutate(
home = paste(
home_team_name, home_team_mascot
),
away = paste(
away_team_name, away_team_mascot
)
) #%>%
.[, -c(1, 2, 4, 10, 14, 18, 24:50, 52:57, 61:62)]
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
) %>%
mutate(
home = paste(
home_team_name, home_team_mascot
),
away = paste(
away_team_name, away_team_mascot
)
) %>%
.[, -c(1, 2, 4, 10, 14, 18, 24:50, 52:57, 61:62)]
espn_id <- 401705400
nba_id <- 22400834
game_pbp_hoopR <- load_nba_pbp() %>%
filter(
game_id == espn_id
) %>%
mutate(
home = paste(
home_team_name, home_team_mascot
),
away = paste(
away_team_name, away_team_mascot
)
) %>%
.[, -c(1, 2, 4, 10, 14, 18, 24:50, 52:57, 61:62)]
game_pbp_nbastatR <- play_by_play(nba_id)     # play by play for nba game id
game_pbp_hoopR_nba <- nba_pbp(nba_id)
View(game_pbp_hoopR_nba)
head(game_pbp_hoopR)
View(game_pbp_hoopR)
colnames(game_pbp_hoopR_nba)
